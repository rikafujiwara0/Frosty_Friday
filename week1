/* I reffered to Information Lab

https://theinformationlab.nl/en/2022/08/18/frosty-friday-developing-snowflake-skills/

*/

// Creating a Warehouse

CREATE WAREHOUSE SNOWFLAKE_FF_WH
WITH
	WAREHOUSE_SIZE = XSMALL
    AUTO_SUSPEND = 60
    AUTO_RESUME = TRUE
    INITIALLY_SUSPENDED = TRUE
    STATEMENT_QUEUED_TIMEOUT_IN_SECONDS = 300
    STATEMENT_TIMEOUT_IN_SECONDS = 600 ;

// Creating a database
CREATE DATABASE SNOWFLAKE_FF;

// Creating a Schema
CREATE SCHEMA CHALLENGES;

// Environment Configuration
USE WAREHOUSE SNOWFLAKE_FF_WH
USE DATABASE SNOWFLAKE_FF
USE SCHEMA CHALLENGESã€€

// CSV FILE FORMAT
CREATE OR REPLACE FILE FORMAT CSV_FORMAT
	TYPE = 'CSV'
    FIELD_DELIMITER = ','
    SKIP_HEADER = 1;

// STAGE
CREATE OR REPLACE STAGE CSV_STAGE_EXTERNAL
	FILE_FORMAT = CSV_FORMAT
    URL = 's3://frostyfridaychallenges/challenge_1/';

// LIST OBJECTS IN STAGE
LIST @CSV_STAGE_EXTERNAL;

// CHECK THE CSV IN STAGE
SELECT $1,$2
FROM @CSV_STAGE_EXTERNAL (FILE_FORMAT => CSV_FORMAT);

//CREATE A TABLE
CREATE OR REPLACE TABLE
SNOWFLAKE_FF.CHALLENGES.CSV_TABLE
	(C1 VARCHAR) ;

// CHECK TABLE
SELECT * FROM CSV_TABLE;

//LOADING CSV DATA INTO TABLE
COPY INTO SNOWFLAKE_FF.CHALLENGES.CSV_TABLE
FROM @CSV_STAGE_EXTERNAL;
